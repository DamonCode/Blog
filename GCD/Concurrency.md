# iOS 多线程编程：使用 NSOperation 和 GCD 进行多线程编程
在 iOS 开发中,并发通常被视作"洪水猛兽"。许多开发者认为这是"危险地带",因此都极力避免使用它。传闻多线程代码应该尽你所能去避免使用。我也认为在你没有很好掌握并发编程的时候,这的确是一个"危险地带"。它的不安全来源于你的无知。想象一下,在人们的一生中,也要面临很多的危险活动,不是么?但是一旦人们掌握了它(技巧),你将能很好的使用它。并发编程拥有两面性,因为你应该掌握如何去使用它。它帮助你构建出有执行效率高,快速的应用,同时,滥用也会导致是你的应用崩溃。这就是为什么在开始使用并发编程技术之前你应该了解哪些 API 可以用来解决问题。在iOS 中有不同的APIs 可供使用。在这篇教程中我们将会介绍我们经常使用的两种 APIs ---- NSOperation 和 Dispatch Queues。 
## 为什么要使用并发?
我知道你是一个有丰富经验的 iOS 开发者。无论你将要开发什么类型的 apps ,你都需要知道并发编程可以是你的应用运行的更快更高效。以下我简要列举几个使用并发的有点:
* **充分利用 iOS 的硬件** : 现在所有的 iOS设备都拥有多核处理器, 这就允许开发者可以并行执行多个任务。所以你应该充分利用这一点(多核处理器),发挥硬件的优势。
* **更好的用户体验**:有时候你会去调用网络服务,进行一些 IO 操作, 或者执行一些其它繁重的事务。如你所知, 在 UI 线程(main thread)做这些操作将会阻塞你的应用, 是程序失去响应。曾经用户面对过这个问题,
他会立马杀掉应用进程。使用多线程,所有这些事务都可以在后台线程完成无需阻塞主线程以及妨碍用户操作。用户可以同时点击按钮,滑动操作应用。
* **NSOpetion 和 GCD 的 APIs 使得多线程编程变得更加简单**:创建和管理线程是一件不容易的任务。这也就是为什么大多数的开发者听到多线程以及并发的时候感到恐惧的原因。在 iOS 开发中, 我们有很多优雅易用的并发 APIs。你无须关心底层如何实现创建或者管理线程。这些 APIs 将会为你做好一切。另外一个重要的优势就是,这些 APIs 帮你完成同步操作来避免竞态条件的发生。当多线程操作一份共享的数据时候可能会发生竞态条件,从而导致意想不到的结果。通过使用synchronization 来保护在多线程之间共享的资源。
## 关于并发你应该知道哪些?
在本教程中, 我们将会向你解释所有你应该掌握理解以及困惑你的知识点。首先我推荐了解 blocks(Swift中的闭包),因为在并发的 APIs 中大量使用到了。然后我们将会讲解 GCD 和 NSOpertionQueues 。我们将会讲解他们的概念,不同以及如何去实现。
## 第一部分:GCD (Grand Central Dispatch)
GCD 最常使用用来管理并发,执行异步任务的 API , GCD 提供以及管理着任务队列。首先, 让我们来看看都有哪些队列。
### 队列是什么?
队列是一种管理对象先入先出(FIFO)的数据结构。队列类似于电影院购票窗口排队的人群。 电影票以先到先被服务的形式进行售卖。队列前边的人比后边的人先买到票。计算机中队列也是类似的,因为先添加进队列的元素首先被移除。
![](http://www.appcoda.com/wp-content/uploads/2015/10/queue-line-2-1166050-1280x960.jpg)
### Dispatch Queues

